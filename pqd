#!/usr/bin/env bash
# Drop columns from parquet JSONL output
# Usage: pqd <col1,col2,...> [parquet-2-json.sh args...]
if [ $# -eq 0 ]; then
  echo "Usage: pqd <col1,col2,...> [args...]" >&2
  exit 1
fi
cols="$1"; shift
# Convert "col1,col2" to '."col1", ."col2"' for jq del()
jq_args=$(echo "$cols" | sed 's/^/."/; s/,/", ."/g; s/$/"/')
parquet-2-json.sh cat "$@" | jq "del($jq_args)"
